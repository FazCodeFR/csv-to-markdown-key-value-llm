<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV → Markdown KV Converter</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%23667eea'/><text x='50' y='70' font-size='60' text-anchor='middle' fill='white' font-family='Arial, sans-serif' font-weight='bold'>M↓</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="gradient-bg min-h-screen py-8 px-4 sm:px-6 lg:px-8">
    <!-- Particules décoratives -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="absolute top-20 left-10 w-72 h-72 bg-purple-300 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"></div>
        <div class="absolute top-40 right-10 w-72 h-72 bg-yellow-300 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse" style="animation-delay: 2s;"></div>
        <div class="absolute -bottom-32 left-1/2 w-72 h-72 bg-pink-300 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse" style="animation-delay: 4s;"></div>
    </div>

    <div class="relative max-w-5xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8 sm:mb-12">
            <div class="inline-block mb-4 float-animation">
                <svg class="w-16 h-16 sm:w-20 sm:h-20 text-white mx-auto drop-shadow-lg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
            </div>
            <h1 class="text-4xl sm:text-5xl font-bold text-white mb-3 drop-shadow-lg">
                CSV → Markdown
            </h1>
            <p class="text-lg sm:text-xl text-white/90 font-light">
                Conversion optimisée pour LLM / RAG / Chatbot
            </p>
        </div>

        <!-- Card principale -->
        <div class="glass-effect rounded-2xl shadow-2xl p-6 sm:p-10">
            <!-- Zone de téléchargement -->
            <div class="mb-8">
                <label for="csvFiles" class="block text-sm font-semibold text-gray-700 mb-3">
                    Sélectionnez vos fichiers CSV
                </label>
                <div id="dropZone" class="file-upload-zone relative border-2 border-dashed border-gray-300 rounded-xl p-8 sm:p-12 text-center cursor-pointer hover:border-purple-400 bg-gray-50/50">
                    <input
                        type="file"
                        id="csvFiles"
                        accept=".csv"
                        multiple
                        class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"
                    >
                    <div class="pointer-events-none">
                        <svg class="w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                        <p class="text-base sm:text-lg font-medium text-gray-700 mb-2">
                            <span class="text-purple-600">Cliquez ou glissez vos fichiers ici</span>
                        </p>
                        <p class="text-xs sm:text-sm text-gray-500">
                            CSV avec délimiteur auto-détecté • Plusieurs fichiers acceptés
                        </p>
                    </div>
                </div>
            </div>

            <!-- Options globales -->
            <div class="mb-8 bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200/50 rounded-xl p-4">
                <h3 class="text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2">
                    <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
                    </svg>
                    Options de conversion
                </h3>
                <div class="flex items-center gap-2">
                    <input
                        type="checkbox"
                        id="hideEmptyValues"
                        class="w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"
                        checked
                    >
                    <label for="hideEmptyValues" class="text-sm text-gray-700 cursor-pointer">
                        Masquer les champs vides
                    </label>
                </div>
            </div>

            <!-- Liste des fichiers sélectionnés -->
            <div id="fileListContainer" class="hidden mb-8">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="text-sm font-semibold text-gray-700">Fichiers sélectionnés</h3>
                    <button id="clearAllBtn" class="text-xs text-red-600 hover:text-red-700 font-medium">
                        Tout supprimer
                    </button>
                </div>
                <div id="fileList" class="space-y-3 bg-gray-50 rounded-lg p-3">
                    <!-- Files will be added here -->
                </div>
            </div>

            <!-- Info format -->
            <div class="mb-8 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200/50 rounded-xl p-4 sm:p-5">
                <div class="flex items-start gap-3">
                    <svg class="w-5 h-5 sm:w-6 sm:h-6 text-blue-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <h3 class="text-sm font-semibold text-gray-800 mb-2">Format de sortie automatique</h3>
                        <ul class="text-xs sm:text-sm text-gray-600 space-y-1">
                            <li class="flex items-center gap-2">
                                <span class="w-1.5 h-1.5 bg-blue-600 rounded-full"></span>
                                <span>Titre configurable (1 à 5 colonnes, défaut: 1)</span>
                            </li>
                            <li class="flex items-center gap-2">
                                <span class="w-1.5 h-1.5 bg-blue-600 rounded-full"></span>
                                <span>Les colonnes du titre ne sont pas répétées dans le corps</span>
                            </li>
                            <li class="flex items-center gap-2">
                                <span class="w-1.5 h-1.5 bg-blue-600 rounded-full"></span>
                                <span>Autres colonnes au format <strong>Clé :</strong> Valeur</span>
                            </li>
                            <li class="flex items-center gap-2">
                                <span class="w-1.5 h-1.5 bg-blue-600 rounded-full"></span>
                                <span>Séparateur <code class="px-1 bg-gray-200 rounded">---</code> entre les entrées</span>
                            </li>
                            <li class="flex items-center gap-2">
                                <span class="w-1.5 h-1.5 bg-blue-600 rounded-full"></span>
                                <span>Détection automatique du délimiteur (;, ,, |, tab)</span>
                            </li>
                            <li class="flex items-center gap-2">
                                <span class="w-1.5 h-1.5 bg-green-600 rounded-full"></span>
                                <span><strong>Encodages :</strong> UTF-8, UTF-8 BOM, Windows-1252 → converti en UTF-8</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Bouton de conversion -->
            <button
                id="convertBtn"
                class="w-full btn-primary text-white font-semibold py-4 px-6 rounded-xl shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none"
                disabled
            >
                <span class="flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    <span id="convertBtnText">Convertir en Markdown</span>
                </span>
            </button>

            <!-- Zone de résultat -->
            <div id="resultArea" class="hidden mt-8 animate-fade-in">
                <div class="bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6 sm:p-8">
                    <div class="flex items-center justify-center gap-3 mb-6">
                        <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <h3 class="text-xl sm:text-2xl font-bold text-gray-800">Conversion réussie !</h3>
                    </div>

                    <!-- Statistiques globales -->
                    <div id="globalStats" class="mb-6 p-4 bg-white/70 rounded-lg border border-green-200">
                        <!-- Stats globales ici -->
                    </div>

                    <div id="downloadList" class="space-y-3">
                        <!-- Download items will be added here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-white/80 text-sm">
            <p>Optimisé pour les fichiers CSV volumineux • Conversion automatique en UTF-8</p>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
